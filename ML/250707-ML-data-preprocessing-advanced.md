# 📅 2025-07-97 TIL - 고급 데이터 전처리 정리 (ML Advanced 1-1, 1-2)

---

## 🧊 데이터 전처리의 중요성

- 전처리는 머신러닝 모델 성능과 **해석 가능성 향상**에 필수
- **결측치/이상치/스케일 차이/범주 인코딩**이 모델에 큰 영향

---

## 🔢 변수 종류 정리

| 구분 | 설명 | 예시 |
|------|------|------|
| 수치형 - 연속형 | 실수형 값, 정규 분포 가능 | 키, 몸무게, 가격 |
| 수치형 - 이산형 | 정수값만 존재 | 거래 수, 나이 |
| 범주형 - 명목형 | 순서 없는 분류 | 성별, 도시명 |
| 범주형 - 순위형 | 순서 있는 분류 | 고객 등급, 만족도 |

---

## 🚫 결측치 처리 (Missing Value)

### 🔍 매커니즘 유형
- MCAR: 완전 무작위 결측
- MAR: 다른 변수에 종속된 무작위 결측
- MNAR: 해당 변수 자체와 관련된 결측

### 🧩 결측치 패턴
- 단일/단조/일반/규칙적 결측

### 🛠 처리 방식
- **삭제**: Listwise/열 제거
- **대체**: 평균/중앙값/최빈값
- **회귀 대체**: 다른 변수로 예측
- **처리 기준**:
  - 10% 미만: 삭제/대체
  - 10~20%: 회귀/Hot-deck
  - 20% 이상: 신중한 회귀 사용

---

## 🚨 이상치 처리 (Outlier)

### ⚠ 이상치 종류
- 점 이상치: 값 하나가 튀는 경우
- 상황적 이상치: 특정 맥락에서 튀는 값 (예: 계절)
- 집단적 이상치: 이상치가 몰려 나타나는 경우

### 📌 탐지 기법
- **Z-score**: 정규 분포 가정, ±3σ
- **IQR**: Q1 - 1.5×IQR, Q3 + 1.5×IQR

### 🧹 처리 방법
- 삭제 / 평균/중앙값 대체 / 변환(log, sqrt)

---

## 📈 연속형 변수 처리

| 방법 | 설명 | 특징 |
|------|------|------|
| 로그 변환 | 오른쪽으로 치우친 분포 완화 | 정규화 도움, 0 이하 불가 |
| 제곱근 변환 | 분포 정규화 | 약한 비대칭에 적합 |
| Box-Cox | 최적 파라미터 기반 | λ값 필요 |
| Min-Max | 0~1 정규화 | 이상치에 민감 |
| Z-score | 표준화 (평균 0, 표준편차 1) | 정규분포에 유리 |
| Robust | 중앙값 기준 스케일링 | 이상치에 강건 |
| 구간화 | 연속 → 범주화 | 복잡도 감소, 해석 쉬움 |

---

## 🧩 범주형 변수 인코딩

| 인코딩 | 특징 | 장단점 |
|--------|------|--------|
| One-Hot | 이진 벡터 | 해석 용이, 차원 증가 |
| Label | 정수로 변환 | 간단, 순서 오해 가능 |
| Frequency | 빈도값으로 치환 | 단일 컬럼, 정보 손실 |
| Target | 목표값 평균으로 인코딩 | 성능↑ 가능, 과적합 위험 |

**과적합 방지법**: 스무딩, K-Fold 인코딩

---

## 🛠 인코딩 예시 코드

```python
from sklearn.preprocessing import OneHotEncoder, LabelEncoder
import category_encoders as ce

# scikit-learn
ohe = OneHotEncoder()
le = LabelEncoder()

# category_encoders
encoder = ce.TargetEncoder(cols=["target_col"])
```

---

## 🧠 오늘의 한줄 요약
데이터 전처리는 **결측치/이상치 처리, 스케일링, 인코딩** 등 모델 입력의 모든 기초를 준비하는 핵심 단계다!

